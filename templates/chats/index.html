{% extends './layouts/dashboard.html' %}

{% block content %}

<link href="static/css/chats.css" rel="stylesheet" type="text/css">

<div id="frame">
	<div id="sidepanel">
		<div id="contacts">
			<ul id = contacts_ul>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status online"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Louis Litt</p>
							<p class="preview">You just got LITT up, Mike.</p>
						</div>
					</div>
				</li>
				<li class="contact active">
					<div class="wrap">
						<span class="contact-status busy"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Harvey Specter</p>
							<p class="preview">Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things.</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status away"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Rachel Zane</p>
							<p class="preview">I was thinking that we could have chicken tonight, sounds good?</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status online"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Donna Paulsen</p>
							<p class="preview">Mike, I know everything! I'm Donna..</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status busy"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Jessica Pearson</p>
							<p class="preview">Have you finished the draft on the Hinsenburg deal?</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Harold Gunderson</p>
							<p class="preview">Thanks Mike! :)</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Daniel Hardman</p>
							<p class="preview">We'll meet again, Mike. Tell Jessica I said 'Hi'.</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status busy"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Katrina Bennett</p>
							<p class="preview">I've sent you the files for the Garrett trial.</p>
						</div>
					</div>
				</li>
				<li class="contact">
					<div class="wrap">
						<span class="contact-status"></span>
						<img src="static/img/user.png" alt="" />
						<div class="meta">
							<p class="name">Charles Forstman</p>
							<p class="preview">Mike, this isn't over.</p>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
	<div class="content">
		<div class="contact-profile">
			<img src="static/img/user.png" alt="" />
			<p>Harvey Specter</p>
			<div class="social-media">
				<i class="fa fa-facebook" aria-hidden="true"></i>
				<i class="fa fa-twitter" aria-hidden="true"></i>
				 <i class="fa fa-instagram" aria-hidden="true"></i>
			</div>
		</div>
		<div class="messages">
			<ul>
				<li class="sent">
					<img src="static/img/user.png" alt="" />
					<p>How the hell am I supposed to get a jury to believe you when I am not even sure that I do?!</p>
				</li>
				<li class="replies">
					<img src="static/img/user.png" alt="" />
					<p>When you're backed against the wall, break the god damn thing down.</p>
				</li>
				<li class="replies">
					<img src="static/img/user.png" alt="" />
					<p>Excuses don't win championships.</p>
				</li>
				<li class="sent">
					<img src="static/img/user.png" alt="" />
					<p>Oh yeah, did Michael Jordan tell you that?</p>
				</li>
				<li class="replies">
					<img src="static/img/user.png" alt="" />
					<p>No, I told him that.</p>
				</li>
				<li class="replies">
					<img src="static/img/user.png" alt="" />
					<p>What are your choices when someone puts a gun to your head?</p>
				</li>
				<li class="sent">
					<img src="static/img/user.png" alt="" />
					<p>What are you talking about? You do what they say or they shoot you.</p>
				</li>
				<li class="replies">
					<img src="static/img/user.png" alt="" />
					<p>Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things.</p>
				</li>
			</ul>
		</div>
    <div class="message-input">
      <div class="wrap">
  			<textarea type="text" placeholder="Write your message..." cols="40" rows="5" style="margin-top: 0px;margin-bottom: 0px;height: 100px;min-height: 100px;max-height: 100px;"></textarea>
		    <div style="background: white;">
          <button class="submit replies" style="height: 40px;margin-top: 60px;">
            <i class="icon-clippy" aria-hidden="true" style=""></i>
          </button>
        </div>

        <div style="background: white;">
          <button class="submit sent" style="height: 40px;margin-top: 60px;">
            <i class="icon-envelop" aria-hidden="true" style=""></i>
          </button>
        </div>
      </div>
  </div>
</div>
</div>

<script >

$(document).ready(function(){
  getMessage();
});

function getMessage(){
    $.ajax({
      type: 'POST',
      url: '/chats',
      data: JSON.stringify({"method":"get_contacts"}),
      success: function(response){
          if (response.result){
            for (var i = 0; i < response.table.length; i++) {
							$('#contacts_ul').append('\
							<li class="contact">\
								<div class="wrap">\
									<span class="contact-status online"></span>\
									<img src="static/img/user.png" alt="" />\
									<div class="meta">\
										<p class="name">'+response.table[i].last_name+' '+response.table[i].first_name+'</p>\
										<p class="preview">'+response.table[i].message+'</p>\
									</div>\
								</div>\
							</li>\
							')
            }
          }
          else {
            console.log(response);
          }
      },
      dataType:"json",
    });
};

function newMessage() {
	message = $(".message-input textarea").val();
	if($.trim(message) == '') {
		return false;
	}
	$('<li class="sent"><img src="static/img/user.png" alt="" /><p>' + message + '<br>-<br>Вы: 2021-09-31 23:38</p></li>').appendTo($('.messages ul'));
	$('.message-input textarea').val(null);
  $('.message-input textarea').focus();
	$('.contact.active .preview').html('<span>You: </span>' + message);
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
};

function newReplies() {
	message = $(".message-input textarea").val();
	if($.trim(message) == '') {
		return false;
	}
	$('<li class="replies"><img src="static/img/user.png" alt="" /><p>' + message + '<br>-<br>Harvey Specter: 2021-09-31 23:38</p></li>').appendTo($('.messages ul'));
	$('.message-input textarea').val(null);
  $('.message-input textarea').focus();
	$('.contact.active .preview').html('<span>You: </span>' + message);
	$(".messages").animate({ scrollTop: $(document).height() }, "fast");
};

$('.submit.sent').click(function() {
  newMessage();
});

$('.submit.replies').click(function() {
  newReplies();
});

</script>

{% endblock %}
